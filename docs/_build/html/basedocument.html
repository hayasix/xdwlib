
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>basedocument &#8212; xdwlib  ドキュメント</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="page" href="page.html" />
    <link rel="prev" title="documentinbinder" href="documentinbinder.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="basedocument">
<h1>basedocument<a class="headerlink" href="#basedocument" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">basedocument</span></code> モジュールは、DocuWorks 文書およびバインダー内文書を
総合して扱います。</p>
<div class="section" id="id1">
<h2>BaseDocument オブジェクト<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>BaseDocument クラスは、Document クラス (DocuWorks 文書) および
DocumentInBinder クラス (バインダー内文書) の基底クラスです。</p>
<p>BaseDocument オブジェクトに対してインデックス表記を用いると、(バインダー内)
文書に含まれるページを Page オブジェクトとして取得できます。
また、インデックスにスライスを指定すると、連続するページ群を
PageCollection オブジェクトとして取得できます。</p>
<p>BaseDocument クラスはイテレータプロトコルをサポートしており、
Page オブジェクトを順次取得できます。</p>
<div class="section" id="id2">
<h3>インスタンスメソッド<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">annotation_text()</span></code></dt><dd><p>(バインダー内) 文書内にあるすべてのテキスト / リンク / 日付印
アノテーションに含まれているテキストデータ (アノテーションテキスト)
を返します。アノテーション間は <code class="docutils literal notranslate"><span class="pre">'\v'</span></code> (0x0b) で、ページ間は
<code class="docutils literal notranslate"><span class="pre">'\f'</span></code> (0x0c) で、それぞれ区切られます。
返されるテキストに含まれる部分は、テキストアノテーションの場合は
設定された文字列の全部、リンクアノテーションの場合はキャプション
文字列の全部、日付印アノテーションの場合は (上欄に設定された文字列) +
<code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">&lt;DATE&gt;</span> <span class="pre">'</span></code> + (下欄に設定された文字列) となります。
返されるテキストはページ順に並んでいます。ただし、アノテーションの
順序は内部状態によっていて、制御できません。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">append(obj)</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">obj</span></code> は Page オブジェクト、PageCollection オブジェクト、BaseDocument
オブジェクトまたは DocuWorks 文書を示すパス名です。 <code class="docutils literal notranslate"><span class="pre">obj</span></code> を
(バインダー内) 文書の末尾に追加します。 <code class="docutils literal notranslate"><span class="pre">insert(self.pages,</span> <span class="pre">obj)</span></code>
と同等です。 <code class="docutils literal notranslate"><span class="pre">insert()</span></code> を参照してください。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">append_image(input_path,</span> <span class="pre">**kw)</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">input_path</span></code> で指定するファイルから画像を読み込んでページを生成し、
(バインダー内) 文書の末尾に追加します。
<code class="docutils literal notranslate"><span class="pre">insert_image(self.pages,</span> <span class="pre">input_path,</span> <span class="pre">**kw)</span></code> と同等です。
<code class="docutils literal notranslate"><span class="pre">insert_image()</span></code> を参照してください。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bitmap(pos)</span></code></dt><dd><p>(バインダー内) 文書の <code class="docutils literal notranslate"><span class="pre">pos</span></code> 番目 (0 から始まります。) のページを
画像化して Bitmap オブジェクトで返します。アノテーションを表示する
設定になっていれば、アノテーションも画像に含めます。Page オブジェクトの
インスタンスメソッド <code class="docutils literal notranslate"><span class="pre">bitmap()</span></code> を参照してください。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">content_text(type=None)</span></code></dt><dd><p>(バインダー内) 文書内のページタイプが <code class="docutils literal notranslate"><span class="pre">type</span></code> (<code class="docutils literal notranslate"><span class="pre">'APPLICATION'</span></code>
または <code class="docutils literal notranslate"><span class="pre">'IMAGE'</span></code> 。省略時は両方) であるすべてのページに含まれる
ページテキスト (アプリケーションテキストまたは OCR テキスト) を
返します。返されるテキストはページ順に並んでいて、ページ間は <code class="docutils literal notranslate"><span class="pre">'\f'</span></code>
(0x0c) で区切られます。ただし、OCR テキストについては、OCR 処理を
行わないと得られません。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">delete(pos)</span></code></dt><dd><p>(バインダー内) 文書の <code class="docutils literal notranslate"><span class="pre">pos</span></code> 番目 (0 から始まります。) のページを
削除します。 <code class="docutils literal notranslate"><span class="pre">pos</span></code> 番目よりも後ろのページのページ位置は、順次
繰り上げられます。 <code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">self[pos]</span></code> としても同じです。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dirname()</span></code></dt><dd><p>(バインダー内) 文書が存在するディレクトリのパス名を返します。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">export(pos,</span> <span class="pre">path=None)</span></code></dt><dd><p>ページを別ファイルに書き出します。
<code class="docutils literal notranslate"><span class="pre">pos</span></code> はページ番号です (0 から始まります)。 <code class="docutils literal notranslate"><span class="pre">path</span></code> は書き出し先の
パス名です。 <code class="docutils literal notranslate"><span class="pre">path</span></code> を設定しない場合は、 <code class="docutils literal notranslate"><span class="pre">self.name</span></code> に <code class="docutils literal notranslate"><span class="pre">'_Pn'</span></code>
(<code class="docutils literal notranslate"><span class="pre">n</span></code> は <code class="docutils literal notranslate"><span class="pre">pos</span> <span class="pre">+</span> <span class="pre">1</span></code>) を付加したもの (
<code class="docutils literal notranslate"><span class="pre">os.path.join(self.dir,</span> <span class="pre">'%s_P%d.xdw'</span> <span class="pre">%</span> <span class="pre">(self.name,</span> <span class="pre">self.pos</span> <span class="pre">+</span> <span class="pre">1))</span></code>
) となります。実際に書き出されたパス名を返します。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">export_image(pos,</span> <span class="pre">path=None,</span> <span class="pre">pages=1,</span> <span class="pre">dpi=600,</span> <span class="pre">color='COLOR',</span> <span class="pre">format=None,</span> <span class="pre">compress='NORMAL',</span> <span class="pre">direct=False)</span></code></dt><dd><p>(バインダー内) 文書のページ (単独または連続する複数ページ) を
画像ファイルへ書き出します。
<code class="docutils literal notranslate"><span class="pre">pos</span></code> はページ番号です (0 から始まります)。 <code class="docutils literal notranslate"><span class="pre">int</span></code> の場合は
単独ページを指定したことになります。連続する複数ページを指定するには、
2 要素のタプル <code class="docutils literal notranslate"><span class="pre">(start,</span> <span class="pre">stop)</span></code> またはリストを指定します。この場合、
<code class="docutils literal notranslate"><span class="pre">start</span></code> ページから <code class="docutils literal notranslate"><span class="pre">stop</span> <span class="pre">-</span> <span class="pre">1</span></code> ページまでが書き出されます。さらに、
<code class="docutils literal notranslate"><span class="pre">pages</span></code> が指定されていたとしても無視されます。
<code class="docutils literal notranslate"><span class="pre">path</span></code> は書き出し先のパス名です。すでに存在する場合は、
<a class="reference external" href="derivativepath.rst">派生したパス名</a> が書き出し先になります。
<code class="docutils literal notranslate"><span class="pre">pages</span></code> は書き出すページ数です。 <code class="docutils literal notranslate"><span class="pre">pos</span></code> が <code class="docutils literal notranslate"><span class="pre">int</span></code> である場合、
第 <code class="docutils literal notranslate"><span class="pre">pos</span></code> ページ (0 から始まります) から <code class="docutils literal notranslate"><span class="pre">pos</span> <span class="pre">+</span> <span class="pre">pages</span> <span class="pre">-</span> <span class="pre">1</span></code> ページ
までが書き出されます。
<code class="docutils literal notranslate"><span class="pre">dpi</span></code> は書き出される画像の解像度です。単位は DPI です。10～600 が
有効です。
<code class="docutils literal notranslate"><span class="pre">color</span></code> は書き出される画像の色数の指定です。 <code class="docutils literal notranslate"><span class="pre">'COLOR'</span></code>, <code class="docutils literal notranslate"><span class="pre">'MONO'</span></code>
または <code class="docutils literal notranslate"><span class="pre">'MONO_HIGHQUALITY'</span></code> (グレースケール) で指定します
(小文字でもかまいません)。
<code class="docutils literal notranslate"><span class="pre">format</span></code> は書き出される画像のデータ形式です。 <code class="docutils literal notranslate"><span class="pre">'BMP'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TIFF'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'JPEG'</span></code> または <code class="docutils literal notranslate"><span class="pre">'PDF'</span></code> で指定します (小文字でもかまいません)。
<code class="docutils literal notranslate"><span class="pre">compress</span></code> は書き出される画像の圧縮形式です。 <code class="docutils literal notranslate"><span class="pre">format</span></code> が <code class="docutils literal notranslate"><span class="pre">'BMP'</span></code>
である場合は、指定は無視されます。 <code class="docutils literal notranslate"><span class="pre">format</span></code> が <code class="docutils literal notranslate"><span class="pre">'TIFF'</span></code> である
場合は、 <code class="docutils literal notranslate"><span class="pre">'NOCOMPRESS'</span></code>, <code class="docutils literal notranslate"><span class="pre">'PACKBITS'</span></code>, <code class="docutils literal notranslate"><span class="pre">'JPEG'</span></code>, <code class="docutils literal notranslate"><span class="pre">'JPEG_TTN2'</span></code>
または <code class="docutils literal notranslate"><span class="pre">'G4'</span></code> を指定します。 <code class="docutils literal notranslate"><span class="pre">format</span></code> が <code class="docutils literal notranslate"><span class="pre">'JPEG'</span></code> である場合は、
<code class="docutils literal notranslate"><span class="pre">'NORMAL'</span></code>, <code class="docutils literal notranslate"><span class="pre">'HIGHQUALITY'</span></code> または <code class="docutils literal notranslate"><span class="pre">'HIGHCOMPRESS'</span></code> を指定します。
<code class="docutils literal notranslate"><span class="pre">format</span></code> が <code class="docutils literal notranslate"><span class="pre">'PDF'</span></code> である場合は、 <code class="docutils literal notranslate"><span class="pre">'NORMAL'</span></code>, <code class="docutils literal notranslate"><span class="pre">'HIGHQUALITY'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'HIGHCOMPRESS'</span></code>, <code class="docutils literal notranslate"><span class="pre">'MRC_NORMAL'</span></code>, <code class="docutils literal notranslate"><span class="pre">'MRC_HIGHQUALITY'</span></code> または
<code class="docutils literal notranslate"><span class="pre">'MRC_HIGHCOMPRESS'</span></code> を指定します。
<code class="docutils literal notranslate"><span class="pre">direct</span></code> が <code class="docutils literal notranslate"><span class="pre">True</span></code> である場合は、ページの画像 (アノテーションや
ページフォームは含みません) を内部の圧縮イメージのまま書き出します。
このため、処理が高速です。生成される画像の形式は内部状態に依存して
TIFF, JPEG または PDF となり、生成される画像ファイルの拡張子はそれぞれ
<code class="docutils literal notranslate"><span class="pre">'.tiff'</span></code>, <code class="docutils literal notranslate"><span class="pre">'.jpeg'</span></code> または <code class="docutils literal notranslate"><span class="pre">'.pdf'</span></code> となります。画像の向きも
内部状態に依存し、DocuWorks Viewer (Lite) で見たときとは異なる場合が
あります。画像の向きは、 <code class="docutils literal notranslate"><span class="pre">self.page(pos).degree</span></code> で取得できます。
実際に書き出しを行ったファイルのパス名を返します。</p>
</dd>
</dl>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">find(pattern,</span> <span class="pre">func=None)</span></code></dt><dd><p>(バインダー内) 文書のすべてのページについて、ページを引数にとる関数
<code class="docutils literal notranslate"><span class="pre">func</span></code> の戻り値が <code class="docutils literal notranslate"><span class="pre">pattern</span></code> にマッチするかどうかを調べ、
マッチしたページだけを集めた PageCollection オブジェクトを返します。
<code class="docutils literal notranslate"><span class="pre">pattern</span></code> は <code class="docutils literal notranslate"><span class="pre">str</span></code> または <code class="docutils literal notranslate"><span class="pre">re</span></code> モジュールで使用できる
正規表現オブジェクトです。 <code class="docutils literal notranslate"><span class="pre">func</span></code> は 1 引数の関数で、引数は Page
オブジェクト、戻り値は引数に対応した文字列であることが必要です。
指定しないときは、 <code class="docutils literal notranslate"><span class="pre">self.fulltext</span></code> と同じです。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">find_annotation_text(pattern)</span></code></dt><dd><p>(バインダー内) 文書のすべてのページについて、各ページのアノテーション
テキスト (全体) が <code class="docutils literal notranslate"><span class="pre">pattern</span></code> にマッチするかどうかを調べ、マッチした
ページだけを集めた PageCollection オブジェクトを返します。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">find_content_text(pattern,</span> <span class="pre">type=None)</span></code></dt><dd><p>(バインダー内) 文書のすべてのページについて、各ページの
アプリケーションテキストまたは OCR テキスト (全体) が <code class="docutils literal notranslate"><span class="pre">pattern</span></code>
にマッチするかどうかを調べ、マッチしたページだけを集めた
PageCollection オブジェクトを返します。  <code class="docutils literal notranslate"><span class="pre">type</span></code> を指定すると、
対象となるページの種類 (<code class="docutils literal notranslate"><span class="pre">'APPLICATION'</span></code>, <code class="docutils literal notranslate"><span class="pre">'IMAGE'</span></code>, <code class="docutils literal notranslate"><span class="pre">'NONE'</span></code>)
を限定します。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">find_fulltext(pattern)</span></code></dt><dd><p>(バインダー内) 文書のすべてのページについて、各ページの
アプリケーションテキストまたは OCR テキスト (全体) および
アノテーションテキストが <code class="docutils literal notranslate"><span class="pre">pattern</span></code> にマッチするかどうかを調べ、
マッチしたページだけを集めた PageCollection オブジェクトを返します。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fulltext()</span></code></dt><dd><p>(バインダー内) 文書のすべてのページテキストおよび テキスト / リンク /
日付印アノテーションに含まれているアノテーションテキストを返します。
返されるテキストはページ順に並んでいて、ページごとに <code class="docutils literal notranslate"><span class="pre">'\f'</span></code> (0x0c)
で区切られ、ページ内では最初にページテキストが置かれ、以後は
<code class="docutils literal notranslate"><span class="pre">'\v'</span></code> (0x0b) で区切られながらアノテーションテキストが続きます。
アノテーションの順序は内部状態によっていて、制御できません。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">insert(pos,</span> <span class="pre">obj)</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">obj</span></code> は Page オブジェクト、PageCollection オブジェクト、
BaseDocument オブジェクトまたは DocuWorks 文書を示すパス名です。
<code class="docutils literal notranslate"><span class="pre">obj</span></code> を (バインダー内) 文書の <code class="docutils literal notranslate"><span class="pre">pos</span></code> 番目 (0 から始まります。)
に挿入します。 <code class="docutils literal notranslate"><span class="pre">obj</span></code> に Binder オブジェクトや DocuWorks バインダーを
示すパス名を指定することはできません。挿入位置以降にあったページの
ページ位置は、順次繰り下げられます。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">insert_image(pos,</span> <span class="pre">input_path,</span> <span class="pre">fitimage='FITDEF',</span> <span class="pre">compress='NORMAL',</span> <span class="pre">zoom=0,</span> <span class="pre">size=Point(0,</span> <span class="pre">0),</span> <span class="pre">align=('CENTER',</span> <span class="pre">'CENTER'),</span> <span class="pre">maxpapersize='DEFAULT')</span></code></dt><dd><p>画像ファイルを読み込み、(バインダー内) 文書の指定位置に
イメージページとして挿入します。
<code class="docutils literal notranslate"><span class="pre">pos</span></code> はページ番号です (0 から始まります)。挿入位置以降にあった
ページのページ位置は、順次繰り下げられます。
<code class="docutils literal notranslate"><span class="pre">input_path</span></code> は読み込むべき画像ファイルです。TIFF, BMP, JPEG が
読み込み可能ですが、形式によっては読み込めないことがあります。
<code class="docutils literal notranslate"><span class="pre">fitimage</span></code> はページサイズの指定です。 <code class="docutils literal notranslate"><span class="pre">'FITDEF'</span></code> (イメージが
収まる定型サイズ), <code class="docutils literal notranslate"><span class="pre">'FIT'</span></code> (イメージサイズそのもの),
<code class="docutils literal notranslate"><span class="pre">'FITDEF_DIVIDEBMP'</span></code> (<code class="docutils literal notranslate"><span class="pre">'FITDEF'</span></code> と同様ですが、BMP 形式の画像が
入力されそれが最大ページサイズ (2A0 または A3) を超過している場合は
分割して複数ページにします), <code class="docutils literal notranslate"><span class="pre">'USERDEF'</span></code> (ユーザー指定サイズ)
または <code class="docutils literal notranslate"><span class="pre">'USERDEF_FIT'</span></code> (ユーザー指定サイズですが、画像がこれより
大きい場合は指定サイズに収まるよう縮小されます) です (小文字でも
かまいません)。
<code class="docutils literal notranslate"><span class="pre">compress</span></code> はカラーイメージの圧縮方式です。 <code class="docutils literal notranslate"><span class="pre">'NORMAL'</span></code> (JPEG標準),
<code class="docutils literal notranslate"><span class="pre">'LOSSLESS'</span></code> (劣化なし), <code class="docutils literal notranslate"><span class="pre">'HIGHQUALITY'</span></code> (JPEG高画質),
<code class="docutils literal notranslate"><span class="pre">'HIGHCOMPRESS'</span></code> (JPEG高圧縮), <code class="docutils literal notranslate"><span class="pre">'MRC_NORMAL'</span></code> (MRC圧縮標準),
<code class="docutils literal notranslate"><span class="pre">'MRC_HIGHQUALITY'</span></code> (MRC圧縮高画質) または
<code class="docutils literal notranslate"><span class="pre">'MRC_HIGHCOMPRESS'</span></code> (MRC圧縮高圧縮) で指定します (小文字でも
かまいません)。
<code class="docutils literal notranslate"><span class="pre">zoom</span></code> は読み込み時の拡大 (・縮小) 率です。単位はパーセントです。
1/1000 % 未満は無視されます。0 を指定すると、100% (等倍) と同じ意味に
なります。
<code class="docutils literal notranslate"><span class="pre">size</span></code> は 生成されるページの大きさです。 <code class="docutils literal notranslate"><span class="pre">fitimage</span></code> が
<code class="docutils literal notranslate"><span class="pre">'USERDEF'</span></code> または <code class="docutils literal notranslate"><span class="pre">'USERDEF_FIT'</span></code> の場合に有効です。Point
オブジェクト (単位はミリメートル)、 <code class="docutils literal notranslate"><span class="pre">int</span></code> または <code class="docutils literal notranslate"><span class="pre">str</span></code> で指定します。
<code class="docutils literal notranslate"><span class="pre">int</span></code> の場合は、1=A3R, 2=A3, 3=A4R, 4=A4, 5=A5R, 6=A5, 7=B4R, 8=B4,
9=B5R, 10=B5 になります。 <code class="docutils literal notranslate"><span class="pre">str</span></code> の場合は、 <code class="docutils literal notranslate"><span class="pre">'A3R'</span></code>, <code class="docutils literal notranslate"><span class="pre">'A3'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'A4R'</span></code>, <code class="docutils literal notranslate"><span class="pre">'A4'</span></code>, <code class="docutils literal notranslate"><span class="pre">'A5R'</span></code>, <code class="docutils literal notranslate"><span class="pre">'A5'</span></code>, <code class="docutils literal notranslate"><span class="pre">'B4R'</span></code>, <code class="docutils literal notranslate"><span class="pre">'B4'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'B5R'</span></code> または <code class="docutils literal notranslate"><span class="pre">'B5'</span></code> で指定します。
<code class="docutils literal notranslate"><span class="pre">align</span></code> は 2 要素のタプル <code class="docutils literal notranslate"><span class="pre">(horiz,</span> <span class="pre">vert)</span></code> でページ内の画像配置を
指定します。 <code class="docutils literal notranslate"><span class="pre">horiz</span></code> は <code class="docutils literal notranslate"><span class="pre">'CENTER'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LEFT'</span></code> または <code class="docutils literal notranslate"><span class="pre">'RIGHT'</span></code>
です。 <code class="docutils literal notranslate"><span class="pre">vert</span></code> は <code class="docutils literal notranslate"><span class="pre">'CENTER'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TOP'</span></code> または <code class="docutils literal notranslate"><span class="pre">'BOTTOM'</span></code> です。
いずれも小文字でもかまいません。
<code class="docutils literal notranslate"><span class="pre">maxpapersize</span></code> は 最大ページサイズで、 <code class="docutils literal notranslate"><span class="pre">'DEFAULT'</span></code>, <code class="docutils literal notranslate"><span class="pre">'A3'</span></code>
または <code class="docutils literal notranslate"><span class="pre">'2A0'</span></code> です。DocuWorks 7.0 以上では、 <code class="docutils literal notranslate"><span class="pre">'DEFAULT'</span></code> と
<code class="docutils literal notranslate"><span class="pre">'2A0'</span></code> は同じ結果となります。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">page(pos)</span></code></dt><dd><p>(バインダー内) 文書の <code class="docutils literal notranslate"><span class="pre">pos</span></code> 番目 (0 から始まります。) のページを表す
Page オブジェクトを返します。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rasterize(pos)</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">pos</span></code> はページ番号です (0 から始まります)。ページがアプリケーション
ページである場合は、イメージページに置き換えます。アプリケーション
ページでない場合は、何もしません。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rotate(pos,</span> <span class="pre">degree=0,</span> <span class="pre">auto=False)</span></code></dt><dd><p>ページを回転します。 <code class="docutils literal notranslate"><span class="pre">pos</span></code> はページ番号です (0 から始まります)。
<code class="docutils literal notranslate"><span class="pre">degree</span></code> はページの中央を中心とした時計回りの回転角で、単位は度です。
<code class="docutils literal notranslate"><span class="pre">auto</span></code> が <code class="docutils literal notranslate"><span class="pre">True</span></code> である場合は、OCR 処理用に自動正立処理を行います。
<code class="docutils literal notranslate"><span class="pre">degree</span></code> に指定できる値は、PIL (Python Imaging Library) が利用できる
場合は任意の整数です。PIL が利用できない場合は、90 の倍数のみ指定
できます。
(注) <code class="docutils literal notranslate"><span class="pre">degree</span></code> が 90 の倍数でない場合、ページを画像にして処理を
進めます。この結果、アノテーションは画像の一部となり、アプリケーション
テキストや OCR テキストも失われます。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">view(light=False,</span> <span class="pre">wait=True)</span></code></dt><dd><p>(バインダー内) 文書の内容を DocuWorks Viewer または DocuWorks Viewer
Light のいずれかで閲覧します。 <code class="docutils literal notranslate"><span class="pre">light</span></code> が真である場合は、DocuWorks
Viewer Light を優先して利用します。 <code class="docutils literal notranslate"><span class="pre">wait</span></code> が真である場合は、
DocuWorks Viewer (Light) が終了するのを待ちます。 <code class="docutils literal notranslate"><span class="pre">wait</span></code> が偽である
場合は、DocuWorks Viewer (Light) を起動したらすぐに制御が戻り、
<code class="docutils literal notranslate"><span class="pre">(proc,</span> <span class="pre">temp)</span></code> という 2 要素からなるタプルを返します。この場合、
<code class="docutils literal notranslate"><span class="pre">proc</span></code> は <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> モジュールが提供する Popen オブジェクト
であり、 <code class="docutils literal notranslate"><span class="pre">temp</span></code> は DocuWorks Viewer (Light) で閲覧中の一時ファイルの
パス名です。
(注) <code class="docutils literal notranslate"><span class="pre">wait</span></code> を <code class="docutils literal notranslate"><span class="pre">False</span></code> とした場合は、 <code class="docutils literal notranslate"><span class="pre">temp</span></code> および
その親ディレクトリは、このメソッドを呼び出した側が必要がなくなった時点で
消去してください。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proc</span><span class="p">,</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">wailt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># ... wait for proc.poll() != None ...</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>  <span class="c1"># shutil.rmtree() を利用してもよい</span>
</pre></div>
</div>
</dd>
</dl>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">xdwlib</a></h1>








<h3>ナビゲーション</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsthis.html">これは何?</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">モジュール概観</a></li>
<li class="toctree-l1"><a class="reference internal" href="xdwfile.html">xdwfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="binder.html">binder</a></li>
<li class="toctree-l1"><a class="reference internal" href="document.html">document</a></li>
<li class="toctree-l1"><a class="reference internal" href="documentinbinder.html">documentinbinder</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">basedocument</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">BaseDocument オブジェクト</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page.html">page</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotation.html">annotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotatable.html">annotatable</a></li>
<li class="toctree-l1"><a class="reference internal" href="struct.html">struct</a></li>
<li class="toctree-l1"><a class="reference internal" href="xdwtemp.html">xdwtemp</a></li>
<li class="toctree-l1"><a class="reference internal" href="derivativepath.html">派生したパス名</a></li>
<li class="toctree-l1"><a class="reference internal" href="halfopenregion.html">半開矩形領域</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">色の指定</a></li>
<li class="toctree-l1"><a class="reference internal" href="fonts.html">フォントの指定</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto.html">HOW-TO</a></li>
<li class="toctree-l1"><a class="reference internal" href="samples.html">サンプルプログラム</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="documentinbinder.html" title="前の章へ">documentinbinder</a></li>
      <li>Next: <a href="page.html" title="次の章へ">page</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2010, HAYASHI Hideki.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/basedocument.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>