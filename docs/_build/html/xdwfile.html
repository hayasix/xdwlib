
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>xdwfile &#8212; xdwlib  ドキュメント</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="binder" href="binder.html" />
    <link rel="prev" title="モジュール概観" href="overview.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="xdwfile">
<h1>xdwfile<a class="headerlink" href="#xdwfile" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">xdwfile</span></code> モジュールでは、Binder および Document クラスの基底クラスである
XDWFile クラスに関連する機能を用意しています。</p>
<div class="section" id="id1">
<h2>モジュール関数<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>xdwfile モジュールでは、次のモジュール関数を利用できます。</p>
<dl>
<dt>copy(input_path, output_path=None)</dt><dd><p>input_path で示されるファイルを単純に複製します。output_path は複製先のパス名です。指定しない場合は、input_path から派生したパス名となります。実際に複製されたファイルのパス名を返します。</p>
</dd>
<dt>create_sfx(input_path, output_path=None)</dt><dd><p>input_path で示される DocuWorks 文書またはバインダーから自己解凍文書 (実行形式) を生成します。output_path は生成先のパス名 (指定しない場合は、input_path と同じ) ですが、拡張子は指定にかかわらず '.exe' とされます。保護された DocuWorks 文書またはバインダーを input_path に指定することはできません。 実際に生成された自己解凍文書のパス名を返します。</p>
</dd>
<dt>extract_sfx(input_path, output_path=None)</dt><dd><p>input_path で示される自己解凍文書 (実行形式) から元の DocuWorks 文書またはバインダーを抽出します。output_path は抽出先のパス名 (指定しない場合は、input_path と同じ) ですが、拡張子は指定に関わらず '.xdw' または '.xbd' となります。実際に抽出された DocuWorks 文書またはバインダーのパス名を返します。</p>
</dd>
<dt>optimize(input_path, output_path=None)</dt><dd><p>input_path で示される DocuWorks 文書またはバインダーを最適化します。output_path は最適化された DocuWorks 文書またはバインダーの出力先のパス名です。指定しない場合は、input_path から派生したパス名となります。最適化により、不要なデータが削除され、(DocuWorks バージョン 3 以前の) MH 圧縮されていた白黒イメージのページが MMR 圧縮へ変換されます。出力先の DocuWorks 文書またはバインダーは、インストールされている DocuWorks が対応する最新のデータ形式となります。保護された DocuWorks 文書またはバインダー、および署名された DocuWorks 文書またはバインダーを input_path に指定することはできません。実際に出力された DocuWorks 文書またはバインダーのパス名を返します。</p>
</dd>
<dt>protect(input_path, output_path=None, protect_type=&quot;PASSWORD&quot;, auth=&quot;NONE&quot;, <a href="#id2"><span class="problematic" id="id3">**</span></a>options)</dt><dd><p>input_path で示される DocuWorks 文書またはバインダーを保護した新たな  DocuWorks 文書またはバインダーを生成します。output_path は生成先のパス名です。指定しない場合は、input_path から派生したパス名となります。protect_type は 'PASSWORD', 'PASSWORD128' または 'PKI' です (小文字でもかまいません)。auth は 'NONE', 'NODIALOG' または 'CONDITIONAL' です (小文字でもかまいません)。実際に生成されたファイルのパス名を返します。</p>
<p>protect_type が 'PASSWORD' または 'PASSWORD128' の場合、<a href="#id4"><span class="problematic" id="id5">**</span></a>options としてキーワード引数 password に読取用パスワード, fullaccess にフルアクセス用パスワード, comment にパスワード入力用ダイアログに表示するコメントを指定します。</p>
<p>protect_type が 'PKI' の場合、<a href="#id6"><span class="problematic" id="id7">**</span></a>options としてキーワード引数 permission に 'EDIT_DOCUMENT', 'EDIT_ANNOTATION', 'PRINT' および 'COPY' (小文字でもかまいせん) のうち 0 個以上をカンマ ',' ではさんで列挙した文字列、certificates に DER (RFC3280) フォーマットの文字列で表現された読取アクセス用証明書のシーケンス、fullaccesscerts に DER (RFC3280) フォーマットの文字列で表現されたフルアクセス用証明書のシーケンスを指定します。</p>
</dd>
<dt>protection_info(path)</dt><dd><p>path で示される DocuWorks 文書またはバインダーの保護状態を示す 2 個の要素からなるタプルを返します。最初の要素は保護の方法を示し、その値は 'PASSWORD', 'PASSWORD128', 'PKI', 'STAMP' または 'CONTEXT_SERVICE' です (小文字でもかまいません)。第二の要素は文書またはバインダーについて許可されている操作を示し、その値は 'EDIT_DOCUMENT', 'EDIT_ANNOTATION', 'PRINT' および 'COPY' (小文字でもかまいません) のうち 0 個以上をカンマ ',' をはさんで列挙した文字列です。</p>
</dd>
<dt>sign(input_path, output_path=None, page=0, position=None, type=&quot;STAMP&quot;, certificate=None)</dt><dd><p>input_path で示される DocuWorks 文書またはバインダーに署名を付加した新たな  DocuWorks 文書またはバインダーを生成します。output_path は生成先のパス名です。指定しない場合は、input_path から派生したパス名となります。page は 署名を表示するページのページ番号 (0 から始まります) です。position は Point オブジェクトまたは None です。None は Point(0, 0) とみなされます。type は 'STAMP' または 'PKI' です (小文字でもかまいません)。certificate は type が 'PKI' である場合に用いる DER (RFC3280) フォーマットの文字列で表現された証明書です。実際に生成されたファイルのパス名を返します。</p>
</dd>
<dt>unprotect(input_path, output_path=None, auth=&quot;NONE&quot;)</dt><dd><p>input_path で示される DocuWorks 文書またはバインダーの保護を解除した新たな  DocuWorks 文書またはバインダーを生成します。output_path は生成先のパス名です。指定しない場合は、input_path から派生したパス名となります。auth は 'NONE', 'NODIALOG' または 'CONDITIONAL' です (小文字でもかまいません)。実際に生成されたファイルのパス名を返します。</p>
</dd>
<dt>xdwopen(path, readonly=False, authenticate=True, autosave=False)</dt><dd><p>path で示される DocuWorks 文書またはバインダーを開きます。readonly が True である場合は、読取専用で開きます。authenticate が True である場合は、保護された DocuWorks 文書またはバインダーであっても、開くパスワードが設定されていない場合、パスワードキャッシュにより認証が成功した場合、および印鑑ケースが開いており認証が成功した場合は開くことができます。authenticate が False である場合は、保護された DocuWorks 文書またはバインダーを開くことはできません。autosave が True である場合は、close() の際に自動的に save() を行います。開かれた DocuWorks 文書またはバインダーを Document オブジェクトまたは Binder オブジェクトで返します。</p>
</dd>
</dl>
<p>XDWFile オブジェクト</p>
<p>XDWFile クラスは、Document クラスおよび Binder クラスの基底クラスで、DocuWorks が扱う 2 種類のファイル形式 (拡張子 .xdw および .xbd) に共通する機能を扱います。</p>
<p>XDWFile クラスはコンテキスト管理プロトコルをサポートしており、with 文で利用できます。次のように利用します。</p>
<dl class="simple">
<dt>with Document(path).open() as doc:</dt><dd><p>...</p>
</dd>
</dl>
<p>または
with xdwopen(path) as doc:</p>
<blockquote>
<div><p>...</p>
</div></blockquote>
<p>コンストラクタ
クラス XDWFile(path)</p>
<blockquote>
<div><p>path は DocuWorks 文書またはバインダーを示すパス名です。ファイル名のうち拡張子は '.xdw' または '.xbd' でなければなりません。実際に文書またはバインダーを操作するには、インスタンスメソッド open() を呼び出す必要があります。</p>
</div></blockquote>
<p>インスタンス属性</p>
<dl class="simple">
<dt>annotatable</dt><dd><p>文書またはバインダーへのアノテーションの追加やアノテーションの編集・削除が許可されている場合は True です。 open() 後に有効な属性です。</p>
</dd>
<dt>attachments</dt><dd><p>文書またはバインダーに添付されたオリジナルデータからなる AttachmentList オブジェクトです。 open() 後に有効な属性です。</p>
</dd>
<dt>authenticate</dt><dd><p>文書またはバインダーを開く際に非対話の認証処理を行ったのであれば True です。非対話の認証処理についてはモジュール関数 xdwopen() を参照してください。open() 後に有効な属性です。</p>
</dd>
<dt>binder_color</dt><dd><p>バインダーの場合、バインダーの色を示します。 open() 後に有効な属性です。</p>
</dd>
<dt>binder_size</dt><dd><p>バインダーの場合、バインダーの大きさを 'A4', 'FREE' などの文字列で示します。 open() 後に有効な属性です。</p>
</dd>
<dt>copyable</dt><dd><p>文書またはバインダーの複製が許可されている場合は True です。 open() 後に有効な属性です。</p>
</dd>
<dt>dir</dt><dd><p>DocuWorks 文書またはバインダーが存在するフォルダ (ディレクトリ) です。</p>
</dd>
<dt>documents</dt><dd><p>バインダーの場合、中に格納されている DocuWorks 文書の個数です。 open() 後に有効な属性です。</p>
</dd>
<dt>editable</dt><dd><p>文書またはバインダーの編集が許可されている場合は True、そうでない場合は False です。 open() 後に有効な属性です。</p>
</dd>
<dt>handle</dt><dd><p>XDWAPI が内部で使用するドキュメントハンドルです。open() 後に有効な属性です。</p>
</dd>
<dt>name</dt><dd><p>文書名です。ファイル名から拡張子 ('.' を含む) を除いた部分と同じです。</p>
</dd>
<dt>pages</dt><dd><p>文書またはバインダーのページ数です。バインダーの場合は、通しでの総ページ数です。 open() 後に有効な属性です。</p>
</dd>
<dt>printable</dt><dd><p>文書またはバインダーの印刷が許可されている場合は True です。 open() 後に有効な属性です。</p>
</dd>
<dt>properties</dt><dd><p>文書またはバインダーに設定されているユーザー定義プロパティの個数です。 open() 後に有効な属性です。</p>
</dd>
<dt>protection</dt><dd><p>DocuWorks 文書またはバインダーの保護に関する 2 要素のタプルです。最初の要素が保護方式 ('PASSWORD', 'PASSWORD128', 'PKI' または 'CONTEXT_SERVICE')、次の要素が許可されている操作 ('EDIT_DOCUMENT', 'EDIT_ANNOTATION', 'PRINT' または 'COPY' の組み合わせをカンマ ',' で区切った文字列) です。</p>
</dd>
<dt>readonly</dt><dd><p>文書またはバインダーを読取専用で開いたのであれば True です。 open() 後に有効な属性です。</p>
</dd>
<dt>signatures</dt><dd><p>文書またはバインダーに付けられている署名の数です。 open() 後に有効な属性です。</p>
</dd>
<dt>status</dt><dd><p>文書またはバインダーに付けられている署名の検証結果です。文書またはバインダーが開かれてからまだ署名の検証が行われていない場合は 'NONE' になります。署名の検証が行われた場合は、署名後にその文書またはバインダーが編集されていれば 'EDIT'、編集されていなければ 'NOEDIT' となります。署名の検証は行われたものの、その文書またはバインダーの内容が破損または改竄されていた場合は 'BAD' となります。 open() 後に有効な属性です。</p>
</dd>
<dt>type</dt><dd><p>文書タイプです。'DOCUMENT' または 'BINDER' となります。</p>
</dd>
<dt>version</dt><dd><p>対応する DocuWorks のバージョン番号です。 open() 後に有効な属性です。</p>
</dd>
</dl>
<p>インスタンスメソッド</p>
<dl class="simple">
<dt>close()</dt><dd><p>文書またはバインダーを閉じます。save() しないでこのメソッドを呼び出すと、open() 後に行った操作がファイルに反映されません。</p>
</dd>
<dt>delete_pageform(sync=False)</dt><dd><p>ページフォームを削除します。sync が True である場合は、update_pageform() と同様にページフォームをそれぞれ削除します。</p>
</dd>
<dt>delform(sync=False)</dt><dd><p>delete_pageform(sync) と同じです。</p>
</dd>
<dt>delprop(name)</dt><dd><p>del_property(name) と同じです。</p>
</dd>
<dt>del_property(name)</dt><dd><p>文書またはバインダーに設定されたユーザー定義のプロパティ name を削除します。</p>
</dd>
<dt>filename()</dt><dd><p>文書またはバインダーのファイル名を返します。拡張子も含まれます。</p>
</dd>
<dt>get_property(name)</dt><dd><p>文書またはバインダーに設定されたユーザー定義のプロパティの値を返します。name が str または unicode である場合は、それをプロパティ名とみなします。name が int である場合は、それをプロパティの番号 (0 から始まる整数) とみなします。文書またはバインダーに設定されているプロパティの個数は、インスタンス属性 properties で参照できます。返される値は、name が int である場合はタプル (プロパティ名, プロパティ値)、name が str または unicode である場合は bool, datetime.date, int または unicode です。</p>
</dd>
<dt>getprop(name)</dt><dd><p>get_property(name) と同じです。</p>
</dd>
<dt>get_userattr(name)</dt><dd><p>文書またはバインダーに設定されたユーザー属性 name の値を str で返します。</p>
</dd>
<dt>has_property(name)</dt><dd><p>文書またはバインダーに設定されたユーザ定義のプロパティ name が存在すれば True を、存在しなければ False を返します。</p>
</dd>
<dt>hasprop(name)</dt><dd><p>has_property(name) と同じです。</p>
</dd>
<dt>open(readonly=False, authenticate=False)</dt><dd><p>文書またはバインダーを開きます。readonly が True である場合は、読取専用で開きます。authenticate が True である場合は、非対話の認証処理を行った上で開きます。self を返します。非対話の認証処理についてはモジュール関数 xdwopen() を参照してください。</p>
</dd>
<dt>optimize(output_path=None)</dt><dd><p>モジュール関数 optimize() と同等です。output_path が指定された場合は、最適化された文書またはバインダーを output_path に書き出します。output_path が指定されなかった場合は、文書またはバインダーのファイル自体を最適化されたものに置き換えます。文書またはバインダーがこのメソッドを呼び出した時点で open() されていた場合は、いったん save() および close() を行い、次に最適化を実施して、再度 open() します。output_path が指定された場合に限り、実際に生成された最適化済みの文書またはバインダーのパス名を返します。</p>
</dd>
<dt>pageform(form)</dt><dd><p>文書またはバインダーに設定されたページフォーム (見出し・ページ番号) のうち種類が form であるものを PageForm オブジェクトで返します。form には 'header', 'footer', 'top_image', 'bottom_image' または 'page_number' を指定します。</p>
</dd>
<dt>pageform_text()</dt><dd><p>文書またはバインダーに設定されたページフォーム (見出し・ページ番号) からテキストを抽出して返します。pageform('header').text + 'v' + pageform('footer').text と同じです。</p>
</dd>
<dt>pathname()</dt><dd><p>文書またはバインダーのフルパス名を返します。</p>
</dd>
<dt>protect(output_path=None, protect_type='PASSWORD', auth='NONE', <a href="#id8"><span class="problematic" id="id9">**</span></a>options)</dt><dd><p>モジュール関数 protect() と同等です。output_path が指定された場合は、保護された文書またはバインダーを output_path に書き出します。output_path が指定されなかった場合は、文書またはバインダーのファイル自体を保護されたものに置き換えます。文書またはバインダーがこのメソッドを呼び出した時点で open() されていた場合は、いったん save() および close() を行い、次に保護を行って、再度 open() します。output_path が指定された場合に限り、実際に生成された保護された文書またはバインダーのパス名を返します。</p>
</dd>
<dt>save()</dt><dd><p>文書またはバインダーを (上書き) 保存します。このメソッドを呼び出さないで close() すると、open() 後に行った操作がファイルに反映されません。</p>
</dd>
<dt>setprop(name, value)</dt><dd><p>set_property(name, value) と同じです。</p>
</dd>
<dt>set_property(name, value)</dt><dd><p>文書またはバインダーのユーザー定義のプロパティ name に値 value を設定します。value は bool, datetime.date, int, str または unicode で指定します。</p>
</dd>
<dt>set_userattr(name, value)</dt><dd><p>文書またはバインダーのユーザー属性 name に値 value を設定します。value は str で指定します。</p>
</dd>
<dt>sign(output_path=None, page=0, position=None, type='STAMP', certificate=None)</dt><dd><p>モジュール関数 sign() と同等です。output_path が指定された場合は、署名された文書またはバインダーを output_path に書き出します。output_path が指定されなかった場合は、文書またはバインダーのファイル自体を署名されたものに置き換えます。文書またはバインダーがこのメソッドを呼び出した時点で open() されていた場合は、いったん save() および close() を行い、次に署名を行って、再度 open() します。output_path が指定された場合に限り、実際に生成された署名後の文書またはバインダーのパス名を返します。</p>
</dd>
<dt>signature(pos)</dt><dd><p>文書またはバインダーに付けられている署名のうち pos 番目 (0 から始まる整数) のものを StampSignature または PKISignature オブジェクトで返します。</p>
</dd>
<dt>unprotect(output_path=None, auth='NONE')</dt><dd><p>モジュール関数 unprotect() と同等です。output_path が指定された場合は、保護を解除された文書またはバインダーを output_path に書き出します。output_path が指定されなかった場合は、文書またはバインダーのファイル自体を保護解除されたものに置き換えます。文書またはバインダーがこのメソッドを呼び出した時点で open() されていた場合は、いったん save() および close() を行い、次に保護を解除して、再度 open() します。output_path が指定された場合に限り、実際に生成された保護解除後の文書またはバインダーのパス名を返します。</p>
</dd>
<dt>update_pageform(sync=False)</dt><dd><p>ページフォーム (見出し・ページ番号) を更新します。pageform() で取得された各ページフォーム (上/下見出し、上/下画像およびページ番号) の属性に設定された内容に従って、ページフォームを更新します。sync が True であり、かつページフォームの設定先 (self.doc) が DocuWorks 文書である場合は、DocuWorks 文書がバインダー内文書であったときに設定されたページフォームも合わせて更新します。sync が True であり、かつページフォームの設定先が DocuWorks バインダーである場合は、バインダー内文書すべてについて、それらが単体の DocuWorks 文書であったときに設定されたページフォームも合わせて更新します。</p>
</dd>
<dt>updform(sync=False)</dt><dd><p>update_pageform(sync) と同じです。</p>
</dd>
</dl>
<p>AttachmentList オブジェクト
AttachmentList クラスは、DocuWorks 文書またはバインダーのオリジナルデータ (添付ファイル) 一覧を扱います。個々のオリジナルデータは、Attachment クラスで扱います。</p>
<p>AttachmentList クラスは、イテレータプロトコルに対応しています。イテレータとして使用した場合、Attachment オブジェクトを順次返します。
コンストラクタ
クラス AttachmentList(doc, size=None)
doc はオリジナルデータが属する DocuWorks 文書またはバインダー (Document オブジェクトまたは Binder オブジェクト) です。size はオリジナルデータの個数です。指定しない場合は doc が持つオリジナルデータの数を自動的に取得して設定します。
インスタンス属性</p>
<p>doc
size</p>
<blockquote>
<div><p>コンストラクタに与える引数と同等です。</p>
</div></blockquote>
<p>インスタンスメソッド</p>
<dl class="simple">
<dt>attachment(pos)</dt><dd><p>オリジナルデータ群の pos 番目 (0 から始まります) のオリジナルデータを Attachment オブジェクトとして返します。pos に負数を指定した場合は、末尾から数えた位置 (-1 が末尾) と解釈します。</p>
</dd>
<dt>append(path)</dt><dd><p>path で示されるファイルをオリジナルデータとして取り込み、オリジナルデータ群の最後に追加します。insert(-1, path) と同じです。</p>
</dd>
<dt>insert(pos, path)</dt><dd><p>path で示されるファイルをオリジナルデータとして取り込み、オリジナルデータ群の pos 番目に挿入します。pos 番目以降にあったオリジナルデータの位置は、順次繰り下げられます。 pos に負数を指定した場合は、末尾から数えた位置 (-1 が末尾) と解釈します。</p>
</dd>
<dt>delete(pos)</dt><dd><p>オリジナルデータ群の pos 番目 (0 から始まります) のオリジナルデータを削除します。pos 番目よりも後ろにあったオリジナルデータの位置は、順次繰り上げられます。 pos に負数を指定した場合は、末尾から数えた位置 (-1 が末尾) と解釈します。</p>
</dd>
<dt>__delitem__(pos)</dt><dd><p>delete(pos) と同じです。</p>
</dd>
<dt>__getitem__(pos)</dt><dd><p>attachment(pos) と同じです。</p>
</dd>
</dl>
<p>Attachment オブジェクト
Attachment クラスは、DocuWorks 文書またはバインダーの個々のオリジナルデータ (添付ファイル) を扱います。
コンストラクタ</p>
<dl class="simple">
<dt>クラス Attachment(doc, pos)</dt><dd><p>doc はオリジナルデータが属する DocuWorks 文書またはバインダー (Document オブジェクトまたは Binder オブジェクト) です。pos は doc.attachments (AttachmentList オブジェクト) の中でのオリジナルデータの位置です (0 から始まります)。pos に負数を指定することはできません。</p>
</dd>
</dl>
<p>インスタンス属性</p>
<dl class="simple">
<dt>datetime</dt><dd><p>ファイルの作成日時です。datetime.datetime オブジェクトです。</p>
</dd>
<dt>name</dt><dd><p>オリジナルデータ名です。ファイル名に相当します。パス名ではありません。</p>
</dd>
<dt>size</dt><dd><p>ファイルの容量です。単位はバイトです。</p>
</dd>
<dt>text_type</dt><dd><p>オリジナルデータ名の格納形式です。'MULTIBYTE' または 'UNICODE' です。</p>
</dd>
</dl>
<p>インスタンスメソッド</p>
<dl class="simple">
<dt>save(path=None)</dt><dd><p>オリジナルデータをファイルシステム上に保存します。path を指定しない場合は、self.name (またはそこから派生したパス名) を用います。</p>
</dd>
</dl>
<p>PageForm オブジェクト</p>
<p>PageForm クラスは、ページフォームを扱います。ページフォームの種類 (上見出し、上画像、下見出し、下画像およびページ番号) ごとに PageForm オブジェクトを生成し、設定を行ったうえで、XDWFile オブジェクトの update_pageform() メソッドを呼び出すと、DocuWorks 文書またはバインダーの見出し等が更新されます。
コンストラクタ
クラス PageForm(doc, form)</p>
<blockquote>
<div><p>PageForm クラスは、上見出し、上画像、下見出し、下画像およびページ番号を扱います。doc はページフォームが属する文書またはバインダー (Document オブジェクトまたは Binder オブジェクト) です。form は 'HEADER', 'TOPIMAGE', 'FOOTER', 'BOTTOMIMAGE' または 'PAGENUMBER' です (小文字でもかまいません)。</p>
</div></blockquote>
<p>インスタンス属性</p>
<dl class="simple">
<dt>alignment</dt><dd><p>表示の水平位置です。 'LEFT', 'CENTER' または 'RIGHT' で指定します (小文字でもかまいません)。</p>
</dd>
<dt>back_color</dt><dd><p>背景色です。色指定についてを参照してください。</p>
</dd>
<dt>beginning_page</dt><dd><p>上/下見出しの開始ページです (0 から始まります)。page_range が 'SPECIFIED' である場合に有効です。</p>
</dd>
<dt>digit</dt><dd><p>ページ番号の桁数です。</p>
</dd>
<dt>doc</dt><dd><p>ページフォームを含む DocuWorks 文書またはバインダー (Document または Binder オブジェクト) です。</p>
</dd>
<dt>ending_page</dt><dd><p>上/見出しの開始ページです (0 から始まります)。page_range が 'SPECIFIED' である場合に有効です。</p>
</dd>
</dl>
<p>font_char_set
font_name
font_pitch_and_family
font_size
font_style</p>
<blockquote>
<div><p>テキストの属性を指定します。フォント指定についてを参照してください。</p>
</div></blockquote>
<dl class="simple">
<dt>fore_color</dt><dd><p>前景色です。色指定についてを参照してください。</p>
</dd>
<dt>form</dt><dd><p>ページフォームの種類です。値は 'HEADER', 'FOOTER', 'TOPIMAGE', 'BOTTOMIMAGE' または 'PAGENUMBER' です。</p>
</dd>
<dt>image_file</dt><dd><p>上/下画像に指定する画像のパス名です。設定のみ行えます。</p>
</dd>
<dt>left_right_margin</dt><dd><p>上/下見出しでの左右の余白です。単位はミリメートルです。1 ミリメートル未満は無視されます。</p>
</dd>
<dt>page_range</dt><dd><p>ページフォームの適用範囲です。'ALL' (小文字でもかまいません) で全ページが、'SPECIFIED' (小文字でもかまいません) で beginning_page から ending_page までが適用範囲になります。</p>
</dd>
<dt>starting_number</dt><dd><p>ページ番号の開始番号です。</p>
</dd>
<dt>text</dt><dd><p>上/下見出しまたはページ番号に表示するテキストです。ページ番号の場合は、'#' が実際のページ番号へ置換されます。</p>
</dd>
<dt>top_bottom_margin</dt><dd><p>上見出しでの上余白、または下見出しでの下余白です。単位はミリメートルです。1 ミリメートル未満は無視されます。</p>
</dd>
<dt>ver_position</dt><dd><p>ページ番号の表示位置です。'TOP' または 'BOTTOM' (小文字でもかまいません) で指定します。</p>
</dd>
<dt>zoom</dt><dd><p>上/下画像の表示倍率です。単位はパーセントです。10 以上 400 以下で指定します。1 未満は無視されます。</p>
</dd>
</dl>
<p>インスタンスメソッド</p>
<dl class="simple">
<dt>update(sync=False)</dt><dd><p>self.doc.update_pageform(sync) と同じです。</p>
</dd>
<dt>delete(sync=False)</dt><dd><p>self.doc.delete_pageform(sync) と同じです。</p>
</dd>
</dl>
<p>BaseSignature オブジェクト</p>
<p>BaseSignature クラスは、StampSignature クラスと PKISignature クラスの基底クラスです。
コンストラクタ</p>
<dl class="simple">
<dt>クラス BaseSignature(doc, pos, page, position, size, dt)</dt><dd><p>doc は署名が属する文書またはバインダー (Document オブジェクトまたは Binder オブジェクト) です。pos は doc の署名一覧の中での位置です (0 から始まります)。page は署名がつけられたページのページ番号です。position は署名の表示位置 (Point オブジェクト) です。size は署名の表示域の大きさ (Point オブジェクト) です。dt は署名日時 (datetime.datetime オブジェクト) です。</p>
</dd>
</dl>
<p>インスタンス属性</p>
<p>コンストラクタに与える引数と同等です。</p>
<p>インスタンスメソッド</p>
<dl class="simple">
<dt>update()</dt><dd><p>署名の状態を取得します。その結果、self.doc.status が更新されます。</p>
</dd>
</dl>
<p>StampSignature オブジェクト
StampSignature クラスは、DocuWorks 内蔵の電子印鑑による署名を扱います。基底クラスは BaseSignature です。
コンストラクタ</p>
<dl class="simple">
<dt>クラス StampSignature(doc, pos, page, position, size, dt, stamp_name=&quot;&quot;, owner_name=&quot;&quot;, valid_until=None, memo=&quot;&quot;, status=None)</dt><dd><p>doc, pos, page, position, size, dt は、BaseSignature の引数と同じです。stamp_name は電子印鑑の名前、owner_name は電子印鑑の所有者として登録された名前です。valid_until は datetime.datetime オブジェクトで、有効期限の終了日時です。memo は電子印鑑に付けられた備考です。status は署名の状態で、'NONE', 'TRUSTED' または 'NOTRUST' のいずれかです。</p>
</dd>
</dl>
<p>インスタンス属性</p>
<p>コンストラクタに与える引数と同等です。
PKISignature オブジェクト
PKISignature クラスは、PKI (公開鍵基盤) 電子証明書による署名を扱います。基底クラスは BaseSignature です。
コンストラクタ</p>
<dl class="simple">
<dt>クラス PKISignature(doc, pos, page, position, size, dt, module='', subjectdn='', subject='', issuerdn='', issuer='', not_before=None, not_after=None, serial=None, certificate=None, memo='', verification_type=None, status=None)</dt><dd><p>doc, pos, page, position, size, dt は、BaseSignature の引数と同じです。
module はセキュリティモジュールの名前です。str です。
subjectdn は SUBJECT DN (distinguished name) の内容 (最大 511 バイト) です。subject は SUBJECT の内容です。これは電子証明書の CN, OU, O または E フィールドにこの順で対応します。issuerdn および issuer は ISSUER DN および ISSUER の内容で、subjectdn および subject と同様です。いずれも str です。
not_before, not_after は datetime.datetime オブジェクトで、それぞれ有効期間の始期と終期です。
serial は署名者の証明書のシリアル番号を16進数で表した文字列 (str) です。
certificate は DER (RFC3280) フォーマットの str で表現された証明書です。
memo は備考の文字列 (str) です。
verification_type は署名の検証方法です。'LOW', 'MID_LOCAL', 'MID_NETWORK', 'HIGH_LOCAL' または 'HIGH_NETWORK' です。
status は署名の状態です。'UNKNOWN', 'OK', 'NO_ROOT_CERTIFICATE', 'NO_REVOCATION_CHECK', OUT_OF_VALIDITY', 'OUT_OF_VALIDITY_AT_SIGNED_TIME, 'REVOKE_CERTIFICATE', 'REVOKE_INTERMEDIATE_CERTIFICATE', 'INVLIAD_SIGNATURE', 'INVALID_USAGE'または 'UNDEFINED_ERROR' です。</p>
</dd>
</dl>
<p>インスタンス属性</p>
<p>コンストラクタに与える引数と同等です。</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">xdwlib</a></h1>








<h3>ナビゲーション</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsthis.html">これは何?</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">モジュール概観</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">xdwfile</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">モジュール関数</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="binder.html">binder</a></li>
<li class="toctree-l1"><a class="reference internal" href="document.html">document</a></li>
<li class="toctree-l1"><a class="reference internal" href="documentinbinder.html">documentinbinder</a></li>
<li class="toctree-l1"><a class="reference internal" href="basedocument.html">basedocument</a></li>
<li class="toctree-l1"><a class="reference internal" href="page.html">page</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotation.html">annotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotatable.html">annotatable</a></li>
<li class="toctree-l1"><a class="reference internal" href="struct.html">struct</a></li>
<li class="toctree-l1"><a class="reference internal" href="xdwtemp.html">xdwtemp</a></li>
<li class="toctree-l1"><a class="reference internal" href="derivativepath.html">派生したパス名</a></li>
<li class="toctree-l1"><a class="reference internal" href="halfopenregion.html">半開矩形領域</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">色の指定</a></li>
<li class="toctree-l1"><a class="reference internal" href="fonts.html">フォントの指定</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto.html">HOW-TO</a></li>
<li class="toctree-l1"><a class="reference internal" href="samples.html">サンプルプログラム</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="overview.html" title="前の章へ">モジュール概観</a></li>
      <li>Next: <a href="binder.html" title="次の章へ">binder</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2010, HAYASHI Hideki.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/xdwfile.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>