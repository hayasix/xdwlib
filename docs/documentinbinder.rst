================
documentinbinder
================

``documentinbinder`` モジュールは、DocuWorks バインダーに含まれる個々の
DocuWorks 文書 (バインダー内文書) を扱います。

DocumentInBinder オブジェクト
=============================

DocumentInBinder オブジェクトは、 DocuWorks バインダーに含まれる個々の
DocuWorks 文書 (バインダー内文書) を表します。これはファイルシステムに
実在するファイルではありません。

DocumentInBinder クラスは、その基底クラスである BaseDocument クラスに
多くを負っています。 ``basedocument`` モジュールを参照してください。

コンストラクタ
--------------

クラス ``DocumentInBinder(bdoc, pos)``
    ``bdoc`` は Binder オブジェクト、 ``pos`` は bdoc 内での格納位置
    (0 から始まる整数) です。

インスタンス属性
----------------

``binder``
    バインダー内文書の格納先となっているバインダーです。

``handle``
    ``self.binder.handle`` と同じです。

``name``
    バインダー内文書のバインダー内文書名です。

    作成時と参照時のシステムロケール (コードページ)が異なる場合は、
    文字化けが生じることがあります。対策として、 ``self.name_compat()``
    を利用できます。

    オリジナルデータ名を保存 (更新) すると、バインダー内文書名は
    現在 (参照時) のシステムロケールで保存されます。
    ただし、現在のシステムロケールで表現できない文字があれば Unicode で
    保存されます。

``pages``
    バインダー内文書のページ数です。

``pos``
    バインダー内文書のバインダー内での位置です。0 から始まります。

インスタンスメソッド
--------------------

``name_compat(encoding, errors='ignore')``
    バインダー内文書のバインダー内文書名を、現在のシステムロケールにかかわらず
    コードページを指定して読み取ります。 ``encoding`` には作成時のロケール
    (日本語 Windows の場合は通常 ``'cp932'``) を指定します。

    このメソッドは、システムロケールを切り替える前に作成したバインダー内文書名
    の文字化けを回避するために用意されています。

``save(path)``
    バインダー内文書を別ファイルに書き出します。 ``path`` は書き出し先のパス名
    です。 ``path`` を設定しない場合は、バインダー内文書名を使用します。実際に
    書き出されたファイルのパス名を返します。
